<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mundo Gamer — Catálogo</title>
  <style>
    :root{
      --bg:#0b0b0b; --card:#111; --muted:#9aa0a6; --accent:#00ff9d;
      --glass: rgba(255,255,255,0.03);
      --max-width:1100px;
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,var(--bg),#071018);
      color:#eef2f3; -webkit-font-smoothing:antialiased;
    }
    .container{max-width:var(--max-width); margin:28px auto; padding:0 16px;}
    header{display:flex; flex-direction:column; align-items:center; margin-bottom:18px; text-align:center}
    header h1{margin:0; color:var(--accent); font-size:2rem}
    header p{margin:4px 0 0 0;color:var(--muted);font-size:1rem}

    .layout{display:grid; grid-template-columns:280px 1fr; gap:18px;}
    @media(max-width:900px){ .layout{grid-template-columns:1fr} .sidebar{order:2} .main{order:1} }

    .sidebar{background:var(--card); padding:14px; border-radius:var(--radius); box-shadow:0 6px 18px rgba(0,0,0,0.6)}
    .sidebar h3{margin:0 0 10px 0; color:var(--accent)}
    .filter-group{margin-bottom:14px}
    label.inline{display:inline-flex; align-items:center; gap:8px; margin:6px 0; cursor:pointer}
    input[type="text"], select, input[type="number"], input[type="range"]{
      width:100%; padding:8px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:var(--glass); color:inherit;
    }
    .small{font-size:0.85rem; color:var(--muted)}

    .controls{display:flex; gap:10px; align-items:center; margin-bottom:12px; flex-wrap:wrap}
    .controls > * {background:var(--card); padding:8px 10px; border-radius:10px}
    .games-grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:14px}

    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.15)); padding:12px; border-radius:12px; overflow:hidden; border:1px solid rgba(255,255,255,0.03)}
    .thumb{height:140px; border-radius:10px; overflow:hidden; background:#000; display:flex; align-items:center; justify-content:center}
    .thumb img{width:100%; object-fit:cover; display:block}
    .meta{display:flex; justify-content:space-between; align-items:center; margin-top:8px}
    .title{font-weight:700}
    .muted{color:var(--muted); font-size:0.9rem}
    .badge{background:rgba(0,0,0,0.4); padding:4px 8px; border-radius:8px; font-size:0.85rem}

    .pagination{display:flex; gap:6px; justify-content:center; margin-top:14px}
    .btn{background:transparent; border:1px solid rgba(255,255,255,0.06); padding:6px 10px; border-radius:8px; cursor:pointer}
    .btn.active{background:var(--accent); color:#041012; border-color:transparent}

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(2,6,10,0.72); z-index:50; padding:20px;}
    .modal.open{display:flex}
    .modal-card{width:100%; max-width:960px; background:linear-gradient(180deg,#0f1112,#0b0b0b); border-radius:14px; padding:18px; overflow:auto; max-height:90vh; border:1px solid rgba(255,255,255,0.04)}
    .modal-header{display:flex; justify-content:space-between; align-items:center; gap:12px}
    .carousel{display:flex; gap:8px; margin:12px 0}
    .carousel img{height:160px; object-fit:cover; border-radius:8px}
    .grid-2{display:grid; grid-template-columns:1fr 320px; gap:12px}
    @media(max-width:900px){ .grid-2{grid-template-columns:1fr} .carousel img{height:120px} }
    .specs{background:rgba(255,255,255,0.02); padding:12px; border-radius:10px}
    .close-btn{background:transparent; border:0; color:var(--muted); font-size:1.1rem; cursor:pointer}
    small.note{display:block;color:var(--muted); margin-top:8px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>🎮 Mundo Gamer</h1>
      <p>Catálogo interactivo de videojuegos — filtros, orden y fichas detalladas</p>
    </header>

    <div class="layout">
      <aside class="sidebar">
        <div class="filter-group">
          <h3>Buscar</h3>
          <input id="searchInput" type="text" placeholder="Buscar por nombre..." />
        </div>

<div class="filter-group">
  <h3>Género</h3>
  <div id="typesList" class="small"></div>
</div>

<script>
  const allTypes = ["Acción","Arcade","Aventura","Carreras","Casual","Deporte","Disparos","Estrategia","Familia","Investigación","Lucha","Rol","Plataformas","RPG","Simulación","Terror"];
  const typesList = document.getElementById("typesList");
  allTypes.forEach(t => {
    const id = `type_${t.replace(/\s+/g,'_')}`;
    const wrapper = document.createElement("label");
    wrapper.className = "inline";
    wrapper.innerHTML = `<input type="checkbox" value="${t}" id


        <div class="filter-group">
          <h3>Duración (horas)</h3>
          <select id="durationSelect">
            <option value="all">Todas</option>
            <option value="0-5">0–5</option>
            <option value="5-10">5–10</option>
            <option value="10-20">10–20</option>
            <option value="20-30">20–30</option>
            <option value="30-40">30–40</option>
            <option value="40-50">40–50</option>
            <option value="50-60">50–60</option>
            <option value="60-70">60–70</option>
            <option value="70-80">70–80</option>
            <option value="80-100">80–100</option>
            <option value="100+">+100</option>
          </select>
        </div>

        <div class="filter-group">
          <h3>Precio (€)</h3>
          <select id="priceSelect">
            <option value="all">Todos</option>
            <option value="0">Gratis</option>
            <option value="0-5">0–5</option>
            <option value="5-10">5–10</option>
            <option value="10-20">10–20</option>
            <option value="20-30">20–30</option>
            <option value="30-40">30–40</option>
            <option value="40-50">40–50</option>
            <option value="50-60">50–60</option>
            <option value="60-70">60–70</option>
            <option value="+80">+80</option>
          </select>
        </div>

        <div class="filter-group">
          <h3>Valoración</h3>
          <label class="small">Mínima
            <input type="number" id="minRating" step="0.1" min="0" max="5" value="0" />
          </label>
          <label class="small">Máxima
            <input type="number" id="maxRating" step="0.1" min="0" max="5" value="5" />
          </label>
        </div>

        <div class="filter-group">
          <h3>Rango de fecha</h3>
          <select id="dateRange">
            <option value="all">Todas</option>
            <option value="2000-2002">2000–2002</option>
            <option value="2003-2005">2003–2005</option>
            <option value="2006-2008">2006–2008</option>
            <option value="2009-2011">2009–2011</option>
            <option value="2012-2014">2012–2014</option>
            <option value="2015-2017">2015–2017</option>
            <option value="2018-2020">2018–2020</option>
            <option value="2021-2023">2021–2023</option>
            <option value="2024-2026">2024–2026</option>
          </select>
        </div>

        <div class="filter-group">
          <h3>Reset filtros</h3>
          <button id="resetFilters" class="btn">Limpiar</button>
        </div>
      </aside>

      <main class="main">
        <div class="controls">
          <div>
            <label class="small">Ordenar por</label>
            <select id="sortBy">
              <option value="name">Nombre</option>
              <option value="releaseDate">Fecha lanzamiento</option>
              <option value="price">Precio</option>
              <option value="rating">Valoración</option>
              <option value="duration">Duración</option>
            </select>
          </div>

          <div>
            <label class="small">Dirección</label>
            <select id="sortDir">
              <option value="asc">Ascendente</option>
              <option value="desc">Descendente</option>
            </select>
          </div>

          <div>
            <label class="small">Mostrar por página</label>
            <select id="pageSize"><option>6</option><option>12</option><option>24</option></select>
          </div>

          <div style="margin-left:auto">
            <span class="small muted">Resultados: <strong id="resultCount">0</strong></span>
          </div>
        </div>

        <section>
          <div id="gamesGrid" class="games-grid"></div>
          <div class="pagination" id="pagination"></div>
        </section>
      </main>
    </div>
  </div>

  <!-- Modal detalle (igual que antes) -->
  <div id="modal" class="modal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true">
      <div class="modal-header">
        <div>
          <h2 id="modalTitle"></h2>
          <div id="modalSub" class="muted small"></div>
        </div>
        <div>
          <button class="close-btn" id="closeModal">Cerrar ✕</button>
        </div>
      </div>

      <div class="grid-2" style="margin-top:12px">
        <div>
          <div class="carousel" id="modalImages"></div>
          <p id="modalDesc"></p>

          <div style="margin-top:8px">
            <h4 style="margin:0 0 6px 0">Video</h4>
            <div id="modalVideo"></div>
          </div>
        </div>

        <aside>
          <div class="specs">
            <div><strong>Duración:</strong> <span id="modalDuration"></span></div>
            <div><strong>Valoración:</strong> <span id="modalRating"></span></div>
            <div><strong>Precio:</strong> €<span id="modalPrice"></span></div>
            <div><strong>Fecha lanzamiento:</strong> <span id="modalDate"></span></div>
            <div><strong>Consolas:</strong> <span id="modalPlatforms"></span></div>
            <div style="margin-top:10px"><strong>Requisitos mínimos</strong><div id="modalReq" class="small muted"></div></div>
            <div style="margin-top:10px"><strong>Reseñas</strong><div id="modalReviews" class="small muted"></div></div>
          </div>
        </aside>
      </div>
    </div>
  </div>

  <script>
    /***********************
     * Datos de ejemplo (igual que antes)
     ***********************/
    const gamesData = [
      {id:"eldenring",name:"Elden Ring",type:["RPG","Acción"],durationMinutes:1200,rating:4.87,reviews:{1:10,2:8,3:50,4:800,5:3400},releaseDate:"2022-02-25",minRequirements:"CPU: Intel i5, RAM: 8GB, GPU: GTX 1060, HDD: 60GB",images:["https://via.placeholder.com/800x450?text=Elden+Ring+1","https://via.placeholder.com/800x450?text=Elden+Ring+2"],video:"https://www.youtube.com/embed/E3Huy2cdih0",description:"Un RPG de mundo abierto de FromSoftware con combate desafiante y exploración profunda.",platforms:["PS4","PS5","XBOX SERIES X","XBOX ONE","PC"],price:59.99},
      {id:"gtavi",name:"GTA VI",type:["Acción","Aventura"],durationMinutes:600,rating:4.12,reviews:{1:200,2:90,3:450,4:1400,5:3200},releaseDate:"2025-10-10",minRequirements:"CPU: Ryzen 5, RAM: 16GB, GPU: RTX 2060, SSD recomendado",images:["https://via.placeholder.com/800x450?text=GTA+VI+1"],video:"https://www.youtube.com/embed/placeholder",description:"Nueva entrega de la saga con mundo abierto y narrativa moderna.",platforms:["PS5","XBOX SERIES X","PC"],price:69.99},
      {id:"marioodyssey",name:"Mario Odyssey",type:["Aventura","Plataformas"],durationMinutes:420,rating:4.55,reviews:{1:5,2:10,3:50,4:800,5:1200},releaseDate:"2017-10-27",minRequirements:"Consola: Nintendo Switch",images:["https://via.placeholder.com/800x450?text=Mario+1","https://via.placeholder.com/800x450?text=Mario+2"],video:"https://www.youtube.com/embed/placeholder",description:"Aventura colorida y creativa con mundos temáticos y mucha exploración.",platforms:["NINTENDO SWITCH"],price:49.95}
    ];

    /***********************
     * Formateo y utilidades
     ***********************/
    function formatRating(r){ return Number(r).toFixed(2); }
    function formatDuration(mins){ const h=Math.floor(mins/60); const m=mins%60; return `${h}h ${m}m`; }
    function yearOf(s){ return new Date(s+"T00:00:00").getFullYear(); }

    /***********************
     * Géneros dinámicos
     ***********************/
    const allTypes = ["Acción","Arcade","Aventura","Carreras","Casual","Deporte","Disparos","Estrategia","Familia","Investigación","Lucha","Rol","Plataformas","RPG","Simulación","Terror"];
    const typesList = document.getElementById("typesList");
    allTypes.forEach(t=>{
      const id = `type_${t.replace(/\s+/g,'_')}`;
      const wrapper = document.createElement("label");
      wrapper.className="inline";
      wrapper.innerHTML=`<input type="checkbox" value="${t}" id="${id}"/> ${t}`;
      typesList.appendChild(wrapper);
    });

    /***********************
     * Variables UI
     ***********************/
    const searchInput=document.getElementById("searchInput");
    const minRatingInput=document.getElementById("minRating");
    const maxRatingInput=document.getElementById("maxRating");
    const durationSelect=document.getElementById("durationSelect");
    const priceSelect=document.getElementById("priceSelect");
    const dateRange=document.getElementById("dateRange");
    const sortBy=document.getElementById("sortBy");
    const sortDir=document.getElementById("sortDir");
    const pageSize=document.getElementById("pageSize");
    const resetFilters=document.getElementById("resetFilters");
    const gamesGrid=document.getElementById("gamesGrid");
    const resultCount=document.getElementById("resultCount");
    const pagination=document.getElementById("pagination");

    const modal=document.getElementById("modal"); const closeModal=document.getElementById("closeModal");
    const modalTitle=document.getElementById("modalTitle"); const modalSub=document.getElementById("modalSub");
    const modalImages=document.getElementById("modalImages"); const modalDesc=document.getElementById("modalDesc");
    const modalVideo=document.getElementById("modalVideo"); const modalDuration=document.getElementById("modalDuration");
    const modalRating=document.getElementById("modalRating"); const modalPrice=document.getElementById("modalPrice");
    const modalDate=document.getElementById("modalDate"); const modalPlatforms=document.getElementById("modalPlatforms");
    const modalReq=document.getElementById("modalReq"); const modalReviews=document.getElementById("modalReviews");

    let currentPage=1;

    /***********************
     * Filtrado avanzado
     ***********************/
    function getActiveTypes(){ return Array.from(document.querySelectorAll("#typesList input:checked")).map(i=>i.value); }
    function matchesDateRange(game,rangeKey){ if(rangeKey==="all")return true; const [y1,y2]=rangeKey.split("-").map(Number); const y=yearOf(game.releaseDate); return y>=y1&&y<=y2; }
    function matchesDuration(game,range){
      if(range==="all") return true;
      if(range==="100+") return game.durationMinutes/60>100;
      const [min,max]=range.split("-").map(Number); return game.durationMinutes/60>=min && game.durationMinutes/60<=max;
    }
    function matchesPrice(game,range){
      if(range==="all") return true;
      if(range==="0") return game.price===0;
      if(range==="+80") return game.price>80;
      const [min,max]=range.split("-").map(Number); return game.price>=min && game.price<=max;
    }

    function applyFilters(){
      const q=searchInput.value.trim().toLowerCase();
      const types=getActiveTypes();
      const minR=Number(minRatingInput.value)||0;
      const maxR=Number(maxRatingInput.value)||5;
      const durR=durationSelect.value;
      const priceR=priceSelect.value;
      const drange=dateRange.value;
      const sortKey=sortBy.value;
      const dir=sortDir.value;

      let results=gamesData.filter(g=>{
        if(q && !g.name.toLowerCase().includes(q)) return false;
        if(types.length && !types.some(t=>g.type.includes(t))) return false;
        if(!matchesDuration(g,durR)) return false;
        if(!matchesPrice(g,priceR)) return false;
        if(g.rating<minR || g.rating>maxR) return false;
        if(!matchesDateRange(g,drange)) return false;
        return true;
      });

      results.sort((a,b)=>{
        let va,vb;
        if(sortKey==="name"){va=a.name.toLowerCase();vb=b.name.toLowerCase();}
        else if(sortKey==="releaseDate"){va=new Date(a.releaseDate);vb=new Date(b.releaseDate);}
        else if(sortKey==="price"){va=a.price;vb=b.price;}
        else if(sortKey==="rating"){va=a.rating;vb=b.rating;}
        else if(sortKey==="duration"){va=a.durationMinutes;vb=b.durationMinutes;}
        if(va<vb) return dir==="asc"?-1:1; if(va>vb) return dir==="asc"?1:-1; return 0;
      });
      return results;
    }

    function renderGames(page=1){
      const pageSz=Number(pageSize.value);
      const all=applyFilters();
      resultCount.textContent=all.length;
      const totalPages=Math.max(1,Math.ceil(all.length/pageSz));
      if(page>totalPages) page=totalPages;
      currentPage=page;
      const start=(page-1)*pageSz;
      const pageItems=all.slice(start,start+pageSz);

      gamesGrid.innerHTML="";
      pageItems.forEach(g=>{
        const card=document.createElement("article"); card.className="card";
        card.innerHTML=`
          <div class="thumb"><img src="${g.images[0]||'https://via.placeholder.com/800x450?text=No+Image'}" alt="${g.name}" /></div>
          <div style="margin-top:10px">
            <div class="meta">
              <div><div class="title">${g.name}</div><div class="muted">${g.type.join(", ")}</div></div>
              <div class="badge">${formatRating(g.rating)} ★</div>
            </div>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px">
              <div class="muted small">⏱ ${formatDuration(g.durationMinutes)}</div>
              <div style="text-align:right"><div class="muted small">€ ${g.price.toFixed(2)}</div>
              <button class="btn" data-id="${g.id}" style="margin-top:6px">Ver</button></div>
            </div>
          </div>
        `;
        gamesGrid.appendChild(card);
      });

      pagination.innerHTML="";
      for(let i=1;i<=totalPages;i++){
        const b=document.createElement("button"); b.textContent=i; b.className="btn"+(i===page?" active":""); b.addEventListener("click",()=>renderGames(i));
        pagination.appendChild(b);
      }
    }

    renderGames(1);

    let debounceTimer;
    ["change","input"].forEach(evt=>{
      document.querySelectorAll("select,input").forEach(el=>{el.addEventListener(evt,()=>{clearTimeout(debounceTimer);debounceTimer=setTimeout(()=>renderGames(1),150);});});
    });

    document.addEventListener("click",ev=>{
      const btn=ev.target.closest("button[data-id]");
      if(btn){openGameModal(btn.dataset.id);}
    });

    resetFilters.addEventListener("click",()=>{
      searchInput.value=""; document.querySelectorAll("#typesList input").forEach(i=>i.checked=false);
      minRatingInput.value=0; maxRatingInput.value=5; durationSelect.value="all"; priceSelect.value="all"; dateRange.value="all";
      sortBy.value="name"; sortDir.value="asc"; pageSize.value=6;
      renderGames(1);
    });

    closeModal.addEventListener("click",()=>{window.location.hash=""; closeModalHandler();});
    modal.addEventListener("click",(e)=>{if(e.target===modal){window.location.hash=""; closeModalHandler();}});

    function openGameModal(id){
      const g=gamesData.find(x=>x.id===id); if(!g) return;
      modalTitle.textContent=g.name;
      modalSub.textContent=`${g.type.join(", ")} • ${g.platforms.join(", ")}`;
      modalImages.innerHTML=""; g.images.forEach(src=>{const img=document.createElement("img"); img.src=src; img.alt=g.name; modalImages.appendChild(img);});
      modalDesc.textContent=g.description;
      modalVideo.innerHTML=g.video?`<iframe width="100%" height="200" src="${g.video}" frameborder="0" allowfullscreen></iframe>":"<small class='muted'>Sin video</small>";
      modalDuration.textContent=formatDuration(g.durationMinutes);
      modalRating.textContent=formatRating(g.rating)+" ★"; modalPrice.textContent=g.price.toFixed(2);
      modalDate.textContent=g.releaseDate; modalPlatforms.textContent=g.platforms.join(", "); modalReq.textContent=g.minRequirements;
      modalReviews.innerHTML=Object.entries(g.reviews).sort((a,b)=>b[0]-a[0]).map(([k,v])=>`${k}★: ${v}`).join("<br>");
      modal.classList.add("open");
      window.location.hash=id;
    }
    function closeModalHandler(){modal.classList.remove("open");}

    if(window.location.hash){ const id=window.location.hash.replace("#",""); openGameModal(id);}
  </script>
</body>
</html>
